<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Yinjie - GitHub.io : Yinjie - GitHub.io">
    <title>AMP （Accelerated Mobile Pages）</title>
    <link rel="stylesheet" type="text/css" media="screen" href="/css/stylesheet.css">
    <link rel="stylesheet" href="/css/github-gist.css">
        <!--[if lt IE 9]>
        <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        <script src="/js/jquery-1.11.3.js"></script>
        <script src="/js/highlight.pack.js"></script>
</head>

<body class="mainpage">

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
            <a id="forkme_banner" href="https://github.com/yj1438">View on GitHub</a>

            <h1 id="project_title">Yinjie - GitHub.io</h1>
            <h2 id="project_tagline">Yinjie - GitHub.io</h2>

        </header>
    </div>

    <div id="main_content_wrap" class="outer">
        <section id="main_content" class="inner">
            <h1>AMP</h1>

<h2>什么是 AMP</h2>

<blockquote><h4><strong>引言：</strong></h4>

<p>对许多人来说，在手机上看页面（webview）是一个很慢的、不靠谱的经历，但它不应该是这样的。加速移动端页面（AMP）项目是一个开源项目，它对移动端的页面进行了大幅的优化，开发人员可以借助它来构造网页。一旦拥有，瞬间加载---无处不在。</p></blockquote>

<p><a href="https://www.ampproject.org/">AMP</a> （Accelerated Mobile Pages ）是谷歌推动的一项专门针对移动端网页加速的项目。根据官方的测试报告，使用的 AMP 技术的页面在 3G 情况下，<strong>首屏显示时间</strong>会有 15% ~ 85% 的性能提升。</p>

<h2>AMP 工作原理</h2>

<p>AMP 主要由三部分构成，AMP HTML、AMP Runtime、AMP Components</p>

<h3>AMP HTML</h3>

<p>AMP 对应用此技术的页面 DOM 做出一些规定</p>

<h5>页面必需的规范</h5>

<ul>
<li>doctype 必须是 <code>&lt;!doctype html&gt;</code></li>
<li>顶层 html 标签必须包含 AMP 属性： <code>&lt;html ⚡&gt;</code> (<code>&lt;html amp&gt;</code> 也可以)</li>
<li>包含 <code>&lt;head&gt;</code> 和 <code>&lt;body&gt;</code> 标签</li>
<li>在 head 中包含一个 <code>&lt;link rel="canonical" href="$SOME_URL" /&gt;</code> 标签，这个标签指出该页面普通版本的 URL，如果只有一个版本，使用当前的 URL 就可以。（告诉搜索引擎，这是同一个页面的不同版本，否则搜索引擎会认为此页面有两个 URL，会认为是作弊）</li>
<li>必须将 <code>&lt;meta charset="utf-8"&gt;</code> 放置在 HEAD 的最上面</li>
<li>HEAD 中必须包含 <code>&lt;meta name="viewport" content="width=device-width,minimum-scale=1"&gt;</code>，也可以在里添入<code>initial-scale=1</code> (1)</li>
<li>在 HEAD 中引入 AMP 核心 JS 文件 ：<code>&lt;script async src="https://cdn.ampproject.org/v0.js"&gt;&lt;/script&gt;</code></li>
<li>在 HEAD 中写入以下代码 <br><code>&lt;style&gt;body {opacity: 0}&lt;/style&gt;&lt;noscript&gt;&lt;style&gt;body {opacity: 1}&lt;/style&gt;&lt;/noscript&gt;</code></li>
</ul>


<p>(1) <code>width=device-width,minimum-scale=1</code> 需要打开<a href="https://www.chromium.org/developers/design-documents/chromium-graphics/how-to-get-gpu-rasterization">GPU rasterization</a></p>

<h5>DOM 元素规范</h5>

<table>
<thead>
<tr>
<th> Tag       </th>
<th> Status in AMP HTML                             </th>
</tr>
</thead>
<tbody>
<tr>
<td> script    </td>
<td> Prohibited unless the type is <code>application/ld+json</code> (Other non-executable values may be added as needed.). Exception is the mandatory script tag to load the AMP runtime and the script tags to load extended components. </td>
</tr>
<tr>
<td> base      </td>
<td> Prohibited </td>
</tr>
<tr>
<td> img       </td>
<td> Replaced with amp-img </td>
</tr>
<tr>
<td> video     </td>
<td> Replaced with amp-video </td>
</tr>
<tr>
<td> audio     </td>
<td> Replaced with amp-audio </td>
</tr>
<tr>
<td> iframe    </td>
<td> Replaced with amp-iframe </td>
</tr>
<tr>
<td> frame     </td>
<td> Prohibited. </td>
</tr>
<tr>
<td> frameset  </td>
<td> Prohibited. </td>
</tr>
<tr>
<td> object    </td>
<td> Prohibited. </td>
</tr>
<tr>
<td> param     </td>
<td> Prohibited. </td>
</tr>
<tr>
<td> applet    </td>
<td> Prohibited. </td>
</tr>
<tr>
<td> embed     </td>
<td> Prohibited. </td>
</tr>
<tr>
<td> form      </td>
<td> Prohibited. </td>
</tr>
<tr>
<td> input elements </td>
<td> Prohibited. Includes input, textarea, select, option. Notably, button element is allowed. </td>
</tr>
<tr>
<td> button    </td>
<td> Allowed. </td>
</tr>
<tr>
<td> <a name="cust"></a>style     </td>
<td> <a href="#opacity">Required style tags for adjusting opacity</a> One additional style tag is allowed in head tag for the purpose of custom styling. This style tag must have the attribute <code>amp-custom</code>. <a href="#cust">🔗</a> </td>
</tr>
<tr>
<td> link      </td>
<td> Allowed for certain values of rel: <code>canonical</code>. <code>stylesheet</code> is generally disallowed, but some values may be whitelisted for font providers. </td>
</tr>
<tr>
<td> meta      </td>
<td> The <code>http-equiv</code> attribute is banned. Otherwise allowed. </td>
</tr>
<tr>
<td> <a name="ancr"></a>a         </td>
<td> The <code>href</code> attribute value must not begin with <code>javascript:</code>. If set, the <code>target</code> attribute value must be <code>_blank</code>. Otherwise allowed. <a href="#ancr">🔗</a> </td>
</tr>
<tr>
<td> svg       </td>
<td> Most SVG elements are allowed </td>
</tr>
</tbody>
</table>


<h3>AMP Runtime</h3>

<p>在上面的基础上，AMP Runtime（就是 HEAD 中最的引入的那个 JS）负责协调各个 DOM 与资源的加载时机与优先级，以及提供验证器等调试功能。</p>

<p>如果你不知道你的页面是否符合 AMP 的规范，你可以在访问的 URL 中加入 #development=1 来打开开发者模式。这时 AMP 会加载验证器，检测页面，并在控制台显示不符合 AMP 规范的位置信息</p>

<h3>AMP Components</h3>

<p>AMP 通过自定义元素提供了一些组件，分为两类：<strong>内置组件</strong>与<strong>扩展组件</strong></p>

<p>用来替换 <code>&lt;img&gt;</code> 、<code>&lt;video&gt;</code> 等标签，从页优化对资源的加载策略，</p>

        </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
        <footer class="inner">
            <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
        </footer>
    </div>

<script>
    hljs.initHighlightingOnLoad({useBR: true});
    $(document).ready(function() {
        $('pre code').each(function(i, block) {
            hljs.highlightBlock(block);
        });
    });
</script>

</body>

</html>